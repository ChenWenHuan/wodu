(function(a){a.oauth2=function(f,d,e){var c=function(j){var l="";if(!j.client_id){l+=" client_id"}if(!j.auth_url){l+=" auth_url"}if(!j.response_type){l+=" response_type"}if(!j.client_secret&&j.response_type=="code"){l+=" client_secret"}if(!j.token_url&&j.response_type=="code"){l+=" token_url"}if(!j.redirect_uri){l+=" redirect_uri"}if(l){var k="Oauth2 parameters missing:"+l;e(k,{error:k});return false}else{return true}};var i=function(j){if(j.logout_url){var k=document.createElement("script");k.src=j.logout_url;a("head").append(k)}};String.prototype.getParam=function(l){l=l.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var k=new RegExp("[\\?&]*"+l+"=([^&#]*)");var j=k.exec(this);if(j==null){return""}else{return j[1]}};if(!c(f)){return}var g={client_id:f.client_id,redirect_uri:f.redirect_uri,response_type:f.response_type};a.extend(g,f.other_params);var b=f.auth_url+"?"+a.param(g);var h=window.open(b,"_blank","location=yes");a(h).on("loadstart",function(m){var k=m.originalEvent.url;if(f.response_type=="code"){k=k.split("#")[0];var l=k.getParam("code");var j=k.getParam("error");if(l||j){h.close();i(f);if(l){a.ajax({url:f.token_url,data:{code:l,client_id:f.client_id,client_secret:f.client_secret,redirect_uri:f.redirect_uri,grant_type:"authorization_code"},type:"POST",success:function(o){var p;if((o instanceof Object)){p=o.access_token}else{p=o.getParam("access_token")}d(p,o)},error:function(o){e(o,o)}})}else{if(j){e(j,k.split("?")[1])}}}}else{if(f.response_type=="token"){var n=k.split("access_token=")[1];var j=k.split("error=")[1];if(n||j){h.close();i(f);if(n){d(n,k.split("#")[1])}else{if(j){e(j,k.split("#")[1])}}}}}})}}(jQuery));